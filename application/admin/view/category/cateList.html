{extend name="index/index"}

{block name="main"}
        <!-- page heading start-->
        <div class="page-heading">
            <h3>
                Editable Table
            </h3>
            <ul class="breadcrumb">
                <li>
                    <a href="#">Dashboard</a>
                </li>
                <li>
                    <a href="#">Data Table</a>
                </li>
                <li class="active"> Editable Table </li>
            </ul>
        </div>
        <!-- page heading end-->

        <!--body wrapper start-->
        <div class="wrapper">
             <div class="row">
                <div class="col-sm-12">
                <section class="panel">
                <header class="panel-heading">
                    分类操作
                    <span class="tools pull-right">
                        <a href="javascript:;" class="fa fa-chevron-down"></a>
                        <a href="javascript:;" class="fa fa-times"></a>
                     </span>
                </header>
                <div class="panel-body">
                <div class="adv-table editable-table ">
                <div class="clearfix">
                    <!-- <div class="btn-group">
                        <button id="editable-sample_new" class="btn btn-primary">
                            Add New <i class="fa fa-plus"></i>
                        </button>
                    </div> -->
                   <!--  <div class="btn-group pull-right">
                        <button class="btn btn-default dropdown-toggle" data-toggle="dropdown">Tools <i class="fa fa-angle-down"></i>
                        </button>
                        <ul class="dropdown-menu pull-right">
                            <li><a href="#">Print</a></li>
                            <li><a href="#">Save as PDF</a></li>
                            <li><a href="#">Export to Excel</a></li>
                        </ul> -->
                    </div>
                </div>
                <div class="space15"></div>
                <table class="table table-striped table-hover table-bordered" id="editable-sample">
                <thead>
                <tr>
                    <th >编号</th>
                    <th align="center" valign="middle">分类名称</th>
                    <th align="center" valign="middle">操作</th>
                    
                </tr>
                </thead>

                <tbody>
                 {volist name="list" id="v"}
                <tr>
                    <td>{$v.c_id}</td>
                    <td class="col-md-4">{$v.c_name}</td>
                    <td class="col-md-4">
                        <a class=" btn btn-success" href="/category/{$v.c_id}">查看子分类</a>
                        <a class=" btn btn-success" href="{:url('admin/category/edit',['id'=>$v['c_id']])}">修改分类</a>
                        <a class=" btn btn-success del-btn" cate-id="{$v.c_id}" href="/category/{$v.c_id}">删除</a>
                    </td>
                   
                </tr>
                 {/volist}
                </tbody>
                </table>
                </div>
                </div>
                </section>
                </div>
                </div>
        </div>
        <!--body wrapper end-->

        <!--footer section start-->
        <footer>
            2014 &copy; AdminEx by <a href="http://www.tcode.me/" target="_blank">淘代码</a>
        </footer>
        <!--footer section end-->

    </div>
    <!-- main content end-->
{/block}
{block name="myjs"}
<!-- Placed js at the end of the document so the pages load faster -->
<script src="/static/app/admin/js/jquery-1.10.2.min.js"></script>
<script src="/static/app/admin/js/jquery-ui-1.9.2.custom.min.js"></script>
<script src="/static/app/admin/js/jquery-migrate-1.2.1.min.js"></script>
<script src="/static/app/admin/js/bootstrap.min.js"></script>
<script src="/static/app/admin/js/modernizr.min.js"></script>
<script src="/static/app/admin/js/jquery.nicescroll.js"></script>

<!--data table-->
<script type="text/javascript" src="/static/app/admin/js/data-tables/jquery.dataTables.js"></script>
<script type="text/javascript" src="/static/app/admin/js/data-tables/DT_bootstrap.js"></script>

<!--common scripts for all pages-->
<script src="/static/app/admin/js/scripts.js"></script>

<!--script for editable table-->
<script src="/static/app/admin/js/editable-table.js"></script>

<!-- END JAVASCRIPTS -->
<script>
    jQuery(document).ready(function() {
        EditableTable.init();
    });
</script>

<script type="text/javascript">
    $(function(){
        //触发类别的删除操作
        $('.del-btn').click(function(){

            var cate_id = $(this).attr('cate-id');
            // console.log(cate_id);
            if (confirm('你确定要 [ 删除 ] 该分类么?')) {
                var obj = $(this).parents('tr');
                //console.log(obj);
                delAjax(cate_id, obj);// 调用执行AJAX删除
            }
        });
    });
   // 设置弹框参数
    toastr.options = {
        closeButton: true,//是否显示关闭按钮
        progressBar: true,//实现显示计时条
        timeOut: "3000",//自动关闭时间
        positionClass: "toast-bottom-left"//提示位置
        // toast-top-full-width 顶端，宽度铺满整个屏幕
        // toast-top-right  顶端右边
    };
    //执行Ajax操作
    function delAjax(id, obj) {
        $.ajax({
            type: 'delete', // DELETE请求方式
            url: '/category/' + id,
            dataType: 'json',
            success: function (data) {
                // console.log(data);
                if (data.status) {
                    // 将当前的节点删除掉
                    obj.remove();

                } else {
                   //删除失败
                   console.log(删除失败);
                }
            },
            error: function () {
                // AJAX操作失败
                alert('AJAX操作失败');
            }
        });
    }
</script>
{/block}